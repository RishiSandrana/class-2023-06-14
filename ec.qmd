---
title: "Economic Connectedness"
author: "Rishi Sandrana"
format: html
---

```{r}
#| echo: false
#| message: false
library(tidyverse)
```

```{r}
#| echo: false
#| message: false
x <- read_csv(file = "data/social_capital_county.csv")
x |> separate_wider_delim(
    cols = county_name, 
    delim = ", ", 
    names = c("county_name", "state_name")
  ) |>
  group_by(state_name) |>
  select(county_name, ec_county, pop2018) |>
  summarize(
    avg_connectedness = mean(ec_county, na.rm = TRUE),
    total_population = sum(pop2018, na.rm = TRUE)
  ) |>
  ggplot(aes(x = total_population, y = avg_connectedness)) + 
  geom_point() + 
  scale_x_log10(labels = scales::comma_format()) + 
  geom_smooth(method = "lm", se = FALSE)
```
